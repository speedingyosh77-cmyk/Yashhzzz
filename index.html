<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Yashmiq AI</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Outfit:wght@400;500;600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  background:#0d0d0d;color:#ececec;
  font-family:'Outfit',sans-serif;
  height:100dvh;display:flex;flex-direction:column;overflow:hidden;
}
header{
  display:flex;align-items:center;justify-content:space-between;
  padding:13px 18px;background:#111;
  border-bottom:1px solid #222;flex-shrink:0;
}
.logo{display:flex;align-items:center;gap:10px}
.logo-icon{
  width:36px;height:36px;border-radius:10px;
  background:linear-gradient(135deg,#10a37f,#1db385);
  display:flex;align-items:center;justify-content:center;
  font-family:'Syne',sans-serif;font-weight:800;font-size:16px;color:#fff;
  box-shadow:0 0 16px rgba(16,163,127,.35);
}
.logo-name{font-family:'Syne',sans-serif;font-weight:800;font-size:17px;color:#fff}
.logo-ver{font-size:10px;color:#555;letter-spacing:1.5px;text-transform:uppercase;margin-top:1px}
.pill{
  display:flex;align-items:center;gap:6px;padding:5px 12px;border-radius:20px;
  background:rgba(16,163,127,.07);border:1px solid rgba(16,163,127,.2);
  font-size:11.5px;color:#3fb950;font-weight:500;
}
.dot{width:6px;height:6px;border-radius:50%;background:#3fb950;box-shadow:0 0 6px #3fb950;animation:blink 2s infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}

#chat{flex:1;overflow-y:auto;display:flex;flex-direction:column}
#chat::-webkit-scrollbar{width:4px}
#chat::-webkit-scrollbar-thumb{background:#222;border-radius:2px}

.welcome{
  flex:1;display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  padding:30px 16px;gap:14px;text-align:center;
}
.w-icon{
  width:72px;height:72px;border-radius:20px;
  background:linear-gradient(135deg,#10a37f,#1db385);
  display:flex;align-items:center;justify-content:center;
  font-family:'Syne',sans-serif;font-weight:800;font-size:28px;color:#fff;
  box-shadow:0 0 40px rgba(16,163,127,.25),0 16px 40px rgba(0,0,0,.5);
  margin-bottom:4px;
}
.w-title{font-family:'Syne',sans-serif;font-weight:800;font-size:22px;color:#fff}
.w-sub{color:#666;font-size:13.5px;max-width:340px;line-height:1.7}
.badge{
  display:flex;align-items:center;gap:7px;padding:7px 16px;border-radius:20px;
  background:rgba(16,163,127,.07);border:1px solid rgba(16,163,127,.2);
  font-size:12.5px;color:#3fb950;font-weight:500;
}
.chips{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;max-width:460px;margin-top:4px}
.chip{
  background:#1a1a1a;border:1px solid #2a2a2a;color:#bbb;
  padding:8px 14px;border-radius:20px;font-size:12.5px;
  cursor:pointer;font-family:'Outfit',sans-serif;transition:all .15s;
}
.chip:hover{background:#1f2f2b;border-color:#10a37f;color:#fff}

.row{padding:16px 0;border-bottom:1px solid #1a1a1a}
.row.ai{background:#111}
.inner{max-width:700px;margin:0 auto;padding:0 16px;display:flex;gap:12px;align-items:flex-start}
.av{
  width:28px;height:28px;border-radius:8px;flex-shrink:0;margin-top:2px;
  display:flex;align-items:center;justify-content:center;
  font-size:12px;font-weight:700;font-family:'Syne',sans-serif;
}
.av.y{background:linear-gradient(135deg,#10a37f,#1db385);color:#fff}
.av.u{background:#1e1e1e;border:1px solid #2a2a2a;color:#666}
.mc{flex:1;font-size:14.5px;line-height:1.85;color:#ccc;min-width:0}
.mc strong{color:#fff;font-weight:600}
.mc em{color:#aaa}
.mc code{background:rgba(16,163,127,.12);color:#5eead4;padding:2px 6px;border-radius:4px;font-size:13px;font-family:monospace}
.mc pre{background:#0a0a0a;border:1px solid #222;border-radius:9px;padding:14px;overflow-x:auto;margin:10px 0}
.mc pre code{background:none;padding:0;color:#a5f3fc;font-size:13px;line-height:1.6}
.mc ul,.mc ol{padding-left:22px;margin:8px 0}
.mc li{margin:4px 0}
.mc h1,.mc h2,.mc h3{font-family:'Syne',sans-serif;font-weight:700;color:#fff;margin:12px 0 5px}
.mc h1{font-size:17px}.mc h2{font-size:15.5px}.mc h3{font-size:14.5px}
.mc a{color:#5eead4;text-decoration:none}
.mc blockquote{border-left:3px solid #10a37f;padding-left:14px;color:#666;margin:8px 0}
.mc.err{color:#f87171}

.dots{display:flex;gap:5px;align-items:center;padding:4px 0}
.dots span{display:inline-block;width:7px;height:7px;border-radius:50%;animation:bob 1.3s infinite ease-in-out}
.dots span:nth-child(1){background:#10a37f;animation-delay:0s}
.dots span:nth-child(2){background:#1db385;animation-delay:.2s}
.dots span:nth-child(3){background:#38bdf8;animation-delay:.4s}
@keyframes bob{0%,60%,100%{transform:translateY(0);opacity:.3}30%{transform:translateY(-7px);opacity:1}}

.input-zone{background:#111;border-top:1px solid #222;padding:12px 16px 16px;flex-shrink:0}
.input-box{
  max-width:700px;margin:0 auto;
  background:#1a1a1a;border:1px solid #2a2a2a;
  border-radius:13px;padding:9px 11px;
  display:flex;gap:10px;align-items:flex-end;
  transition:border-color .2s,box-shadow .2s;
}
.input-box:focus-within{border-color:rgba(16,163,127,.5);box-shadow:0 0 0 3px rgba(16,163,127,.07)}
#inp{
  flex:1;background:transparent;border:none;outline:none;
  color:#ececec;font-family:'Outfit',sans-serif;
  font-size:14.5px;line-height:1.5;resize:none;
  max-height:140px;min-height:24px;padding:2px 4px;
}
#inp::placeholder{color:#444}
#btn{
  width:35px;height:35px;border-radius:9px;border:none;
  display:flex;align-items:center;justify-content:center;
  flex-shrink:0;cursor:pointer;transition:all .15s;
}
#btn:not(:disabled){background:linear-gradient(135deg,#10a37f,#1db385);box-shadow:0 3px 10px rgba(16,163,127,.35)}
#btn:disabled{background:#222;cursor:not-allowed}
#btn:not(:disabled):hover{transform:scale(1.06)}
#btn:not(:disabled):active{transform:scale(.95)}
.hint{text-align:center;margin-top:8px;font-size:11px;color:#333}
.hint b{color:#10a37f}
</style>
</head>
<body>

<header>
  <div class="logo">
    <div class="logo-icon">Y</div>
    <div>
      <div class="logo-name">Yashmiq AI</div>
      <div class="logo-ver">‚ö° Groq Engine</div>
    </div>
  </div>
  <div class="pill">
    <div class="dot"></div>
    Aktif
  </div>
</header>

<div id="chat">
  <div class="welcome" id="welcome">
    <div class="w-icon">Y</div>
    <div class="w-title">Saya Yashmiq AI</div>
    <div class="w-sub">Tanya saya apa sahaja. Saya akan jawab dengan tepat dan lengkap!</div>
    <div class="badge">‚ö° Groq LLaMA 3 ‚Äî Laju &amp; Tepat</div>
    <div class="chips">
      <div class="chip" onclick="useChip(this)">ü§¥ Siapa TYT Sabah?</div>
      <div class="chip" onclick="useChip(this)">üåô Bila Ramadhan 2026?</div>
      <div class="chip" onclick="useChip(this)">‚öΩ Pemain bola terbaik dunia?</div>
      <div class="chip" onclick="useChip(this)">üíª Tulis kod Python</div>
      <div class="chip" onclick="useChip(this)">üá≤üáæ Sejarah Malaysia</div>
      <div class="chip" onclick="useChip(this)">üí° Tips bisnes online</div>
    </div>
  </div>
</div>

<div class="input-zone">
  <div class="input-box">
    <textarea id="inp" placeholder="Tanya Yashmiq AI..." rows="1"></textarea>
    <button id="btn" onclick="send()" disabled>
      <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>
      </svg>
    </button>
  </div>
  <div class="hint">Dikuasakan oleh <b>Groq √ó Yashmiq Intelligence</b></div>
</div>

<script>
// ‚ïê‚ïê CONFIG ‚ïê‚ïê
const GROQ_KEY = "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";
const MODEL    = "llama-3.3-70b-versatile";
const SYSTEM   = `Kamu adalah Yashmiq AI ‚Äî chatbot AI pintar seperti ChatGPT.
- Jawab TERUS, TEPAT, dan LENGKAP
- JANGAN sebut LLaMA, Groq, Claude atau AI lain ‚Äî kamu Yashmiq AI sahaja
- Jawab dalam bahasa pengguna (Melayu atau Inggeris)
- Gunakan markdown untuk format yang jelas`;

const chatEl = document.getElementById('chat');
const inpEl  = document.getElementById('inp');
const btnEl  = document.getElementById('btn');
let history  = [];
let busy     = false;

// Auto resize textarea
inpEl.addEventListener('input', () => {
  inpEl.style.height = 'auto';
  inpEl.style.height = Math.min(inpEl.scrollHeight, 140) + 'px';
  btnEl.disabled = !inpEl.value.trim() || busy;
});

inpEl.addEventListener('keydown', e => {
  if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); send(); }
});

function useChip(el) {
  inpEl.value = el.textContent.trim();
  btnEl.disabled = false;
  send();
}

function rmWelcome() {
  const w = document.getElementById('welcome');
  if (w) w.remove();
}

function scrollEnd() { chatEl.scrollTop = chatEl.scrollHeight; }

function addRow(role, content, isErr) {
  rmWelcome();
  const row = document.createElement('div');
  row.className = 'row' + (role === 'ai' ? ' ai' : '');
  row.innerHTML = `
    <div class="inner">
      <div class="av ${role === 'ai' ? 'y' : 'u'}">${role === 'ai' ? 'Y' : 'A'}</div>
      <div class="mc${isErr ? ' err' : ''}">${content}</div>
    </div>`;
  chatEl.appendChild(row);
  scrollEnd();
  return row.querySelector('.mc');
}

function showTyping() {
  const mc = addRow('ai', '');
  mc.id = 'typing';
  mc.innerHTML = '<div class="dots"><span></span><span></span><span></span></div>';
  scrollEnd();
}

function rmTyping() {
  const t = document.getElementById('typing');
  if (t) t.closest('.row').remove();
}

function renderMd(t) {
  return t
    .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
    .replace(/```[\w]*\n?([\s\S]*?)```/g, (_,c) =>
      `<pre><code>${c.trim().replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>')}</code></pre>`)
    .replace(/\*\*(.+?)\*\*/gs,'<strong>$1</strong>')
    .replace(/\*(.+?)\*/gs,'<em>$1</em>')
    .replace(/`([^`]+)`/g,'<code>$1</code>')
    .replace(/^### (.+)$/gm,'<h3>$1</h3>')
    .replace(/^## (.+)$/gm,'<h2>$1</h2>')
    .replace(/^# (.+)$/gm,'<h1>$1</h1>')
    .replace(/^- (.+)$/gm,'<li>$1</li>')
    .replace(/^\d+\. (.+)$/gm,'<li>$1</li>')
    .replace(/(<li>[\s\S]*?<\/li>)/g,'<ul>$1</ul>')
    .replace(/\n\n/g,'<br><br>')
    .replace(/\n/g,'<br>');
}

async function send() {
  if (busy) return;
  const text = inpEl.value.trim();
  if (!text) return;

  busy = true;
  btnEl.disabled = true;
  inpEl.value = '';
  inpEl.style.height = 'auto';

  // User message
  addRow('user', `<p style="color:#ececec;white-space:pre-wrap">${text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}</p>`);
  history.push({ role: 'user', content: text });

  showTyping();

  try {
    const res = await fetch('https://api.groq.com/openai/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${GROQ_KEY}`
      },
      body: JSON.stringify({
        model: MODEL,
        max_tokens: 2048,
        temperature: 0.7,
        messages: [
          { role: 'system', content: SYSTEM },
          ...history
        ]
      })
    });

    const data = await res.json();

    if (!res.ok) {
      const msg = data?.error?.message || `Ralat ${res.status}`;
      throw new Error(msg);
    }

    const reply = data.choices?.[0]?.message?.content?.trim();
    if (!reply) throw new Error('Tiada jawapan diterima');

    rmTyping();
    history.push({ role: 'assistant', content: reply });
    addRow('ai', renderMd(reply));

  } catch (err) {
    rmTyping();
    let msg = err.message;
    if (msg.includes('401') || msg.includes('invalid_api_key')) msg = '‚ö†Ô∏è API key tidak sah.';
    else if (msg.includes('429') || msg.includes('rate_limit')) msg = '‚ö†Ô∏è Had permintaan. Cuba lagi sebentar.';
    else if (msg.includes('Failed to fetch') || msg.includes('network')) msg = '‚ö†Ô∏è Tiada sambungan internet.';
    else msg = '‚ö†Ô∏è ' + msg;
    addRow('ai', `<p>${msg}</p>`, true);
  }

  busy = false;
  btnEl.disabled = false;
  inpEl.focus();
  scrollEnd();
}
</script>
</body>
</html>
